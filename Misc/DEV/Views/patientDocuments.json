{"name":"patientDocuments","category":"view","description":"Get last n compositions of the patient","metaData":"{\r\n    \"parameters\": [\r\n        {\r\n            \"name\": \"offset\",\r\n            \"type\": \"number\",\r\n            \"description\": \"Lower limit\"\r\n        },\r\n        {\r\n            \"name\": \"limit\",\r\n            \"type\": \"number\",\r\n            \"description\": \"Upper limit\"\r\n        },\r\n        {\r\n            \"name\": \"search\",\r\n            \"type\": \"string\",\r\n            \"description\": \"Search string\"\r\n        }\r\n    ]\r\n}","steps":[{"processorName":"jsonFtlAql","processorData":"SELECT\r\n    c/name/value as title,\r\n    c/uid/value as uid,\r\n    c/context/start_time/value as startTime,\r\n    c/archetype_details/template_id/value as templateId,\r\n    c/composer/name as creator,\r\n    v/commit_audit/time_committed/value as created\r\nFROM EHR e\r\nCONTAINS VERSIONED_OBJECT vo\r\nCONTAINS VERSION v\r\nCONTAINS Composition c\r\nWHERE e/ehr_id/value = :ehrId\r\n<#if ctx.vars.search??>AND (title LIKE :search OR creator LIKE :search OR created LIKE :search)</#if>\r\nORDER BY created DESC OFFSET :offset LIMIT :limit"}]}