{"name":"getActivePatientFlagByEHR","category":"view","description":"Returns the Composition ID for an active flag based on the patient EHR ID and alert type","metaData":"{\r\n    \"parameters\": [\r\n        {\r\n            \"name\": \"alertcode\",\r\n            \"type\": \"string\",\r\n            \"description\": \"Alert Code String\"\r\n        },\r\n        {\r\n            \"name\": \"ehrId\",\r\n            \"type\": \"string\",\r\n            \"description\": \"EHR Record ID\"\r\n        }\r\n    ]\r\n}","steps":[{"processorName":"jsonFtlAql","processorData":"SELECT\r\n    a/uid/value as compositionID\r\nfrom EHR e\r\ncontains COMPOSITION a[openEHR-EHR-COMPOSITION.patient_flag.v0]\r\ncontains EVALUATION b_a[openEHR-EHR-EVALUATION.patient_flag.v0]\r\nwhere\r\n    a/name/value='Patient Flag' and (\r\n        b_a/data[at0001]/items[at0004]/items[at0012]/value/value=true and\r\n        e/ehr_id/value=:ehrId and\r\n        b_a/data[at0001]/items[at0004]/items[at0007]/value/defining_code/code_string = :alertcode)\r\noffset 0 limit 10"}]}